<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>تسجيل الدخول - Caritas</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="loginPage">
  <div class="container">
    <!-- اللوجو -->
    <img src="logo_caritas.png" alt="Caritas Logo">

    <h1>تسجيل الدخول</h1>

    <input type="text" id="username" placeholder="اسم المستخدم">
    <input type="password" id="password" placeholder="كلمة المرور">

    <button onclick="login()">تسجيل الدخول</button>

    <p>أدخل بياناتك للولوج للنظام</p>
  </div>

  <script type="module">
  import { supabase } from './supabaseClient.js';

  async function login() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;

    const { data, error } = await supabase
      .from('employees')
      .select('*')
      .eq('username', username)
      .eq('password_hash', password)
      .single();

    if (error || !data) {
      alert('خطأ في تسجيل الدخول: المستخدم أو كلمة المرور غير صحيحة');
    } else {
      alert('تم تسجيل الدخول بنجاح!');
      switch (data.role_id) {
        case 5:
          window.location.href = 'adminDashboard.html';
          break;
        case 2:
          window.location.href = 'teamManagerDashboard.html';
          break;
        case 1:
          window.location.href = 'specialistDashboard.html';
          break;
        default:
          alert('الدور غير معروف!');
      }
    }
  }

  window.login = login; // عشان الزرار يعرف الدالة
</script>

</body>

</html>
